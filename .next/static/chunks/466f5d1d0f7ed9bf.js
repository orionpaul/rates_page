(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,79813,e=>{"use strict";e.s(["default",()=>o]);var t=e.i(16918),a=e.i(44661);e.i(96295);var i=e.i(54134);e.i(7503);var d=e.i(85590),r=e.i(77795),s=e.i(71227),l=e.i(11170);function o(){let[e,o]=(0,a.useState)([]),[c,n]=(0,a.useState)(!0),[u,m]=(0,a.useState)(!1),[x,g]=(0,a.useState)(""),[b,h]=(0,a.useState)(null),{user:p}=(0,s.useAuth)();(0,a.useEffect)(()=>{y()},[]);let y=async()=>{n(!0);try{let e=(await (0,i.getDocs)((0,i.collection)(r.db,"media"))).docs.map(e=>({id:e.id,...e.data()}));o(e)}catch(e){console.error("Error fetching media:",e)}finally{n(!1)}},v=async()=>{if(x.trim())try{let e=(0,i.query)((0,i.collection)(r.db,"media"),(0,i.where)("isActive","==",!0));for(let t of(await (0,i.getDocs)(e)).docs)await (0,i.updateDoc)((0,i.doc)(r.db,"media",t.id),{isActive:!1});await (0,i.addDoc)((0,i.collection)(r.db,"media"),{type:"youtube",url:x,isActive:!0,createdAt:(0,i.serverTimestamp)(),updatedBy:(null==p?void 0:p.email)||"unknown"}),g(""),y()}catch(e){console.error("Error adding YouTube URL:",e),alert("Failed to add YouTube URL")}},f=async()=>{if(b){m(!0);try{let e=(0,d.ref)(r.storage,"media/".concat(Date.now(),"_").concat(b.name));await (0,d.uploadBytes)(e,b);let t=await (0,d.getDownloadURL)(e),a=(0,i.query)((0,i.collection)(r.db,"media"),(0,i.where)("isActive","==",!0));for(let e of(await (0,i.getDocs)(a)).docs)await (0,i.updateDoc)((0,i.doc)(r.db,"media",e.id),{isActive:!1});await (0,i.addDoc)((0,i.collection)(r.db,"media"),{type:"image",url:t,isActive:!0,createdAt:(0,i.serverTimestamp)(),updatedBy:(null==p?void 0:p.email)||"unknown"}),h(null),y()}catch(e){console.error("Error uploading image:",e),alert("Failed to upload image")}finally{m(!1)}}},w=async e=>{try{for(let e of(await (0,i.getDocs)((0,i.collection)(r.db,"media"))).docs)await (0,i.updateDoc)((0,i.doc)(r.db,"media",e.id),{isActive:!1});await (0,i.updateDoc)((0,i.doc)(r.db,"media",e),{isActive:!0}),y()}catch(e){console.error("Error setting active media:",e)}},j=async e=>{if(confirm("Are you sure you want to delete this media?"))try{await (0,i.deleteDoc)((0,i.doc)(r.db,"media",e)),y()}catch(e){console.error("Error deleting media:",e)}};return c?(0,t.jsx)("div",{children:"Loading..."}):(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-3xl font-bold text-gray-800 mb-6",children:"Manage Media"}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-gray-800 mb-4",children:"Add YouTube Video"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"YouTube URL"}),(0,t.jsx)("input",{type:"text",value:x,onChange:e=>g(e.target.value),placeholder:"https://www.youtube.com/watch?v=...",className:"w-full px-4 py-2 border border-gray-300 rounded focus:ring-2 focus:ring-cbz-red outline-none"})]}),(0,t.jsx)("button",{onClick:v,className:"w-full bg-cbz-red text-white px-4 py-2 rounded hover:bg-red-700 transition",children:"Add YouTube Video"})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-gray-800 mb-4",children:"Upload Image"}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Image"}),(0,t.jsx)("input",{type:"file",accept:"image/*",onChange:e=>{var t;return h((null==(t=e.target.files)?void 0:t[0])||null)},className:"w-full px-4 py-2 border border-gray-300 rounded focus:ring-2 focus:ring-cbz-red outline-none"})]}),(0,t.jsx)("button",{onClick:f,disabled:!b||u,className:"w-full bg-cbz-red text-white px-4 py-2 rounded hover:bg-red-700 transition disabled:opacity-50 disabled:cursor-not-allowed",children:u?"Uploading...":"Upload Image"})]})]})]}),(0,t.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,t.jsx)("div",{className:"px-6 py-4 border-b border-gray-200",children:(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"All Media"})}),(0,t.jsx)("div",{className:"divide-y divide-gray-200",children:0===e.length?(0,t.jsx)("div",{className:"px-6 py-8 text-center text-gray-500",children:"No media items yet. Add a YouTube video or upload an image."}):e.map(e=>(0,t.jsxs)("div",{className:"px-6 py-4 flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4 flex-1",children:["image"===e.type&&(0,t.jsx)("div",{className:"relative w-24 h-16",children:(0,t.jsx)(l.default,{src:e.url,alt:"Media thumbnail",fill:!0,className:"object-cover rounded"})}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:["youtube"===e.type?"YouTube Video":"Image",e.isActive&&(0,t.jsx)("span",{className:"ml-2 px-2 py-1 text-xs bg-green-100 text-green-800 rounded",children:"Active"})]}),(0,t.jsx)("div",{className:"text-xs text-gray-500 mt-1 truncate max-w-md",children:e.url})]})]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[!e.isActive&&(0,t.jsx)("button",{onClick:()=>w(e.id),className:"px-3 py-1 text-sm bg-green-100 text-green-700 rounded hover:bg-green-200 transition",children:"Set Active"}),(0,t.jsx)("button",{onClick:()=>j(e.id),className:"px-3 py-1 text-sm bg-red-100 text-red-700 rounded hover:bg-red-200 transition",children:"Delete"})]})]},e.id))})]})]})}}]);